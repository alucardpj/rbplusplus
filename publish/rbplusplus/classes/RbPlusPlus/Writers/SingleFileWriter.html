<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Class: RbPlusPlus::Writers::SingleFileWriter</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />

    <script language="JavaScript" type="text/javascript">
    // <![CDATA[

        function toggleSource( id )
        {
          var elem
          var link

          if( document.getElementById )
          {
            elem = document.getElementById( id )
            link = document.getElementById( "l_" + id )
          }
          else if ( document.all )
          {
            elem = eval( "document.all." + id )
            link = eval( "document.all.l_" + id )
          }
          else
            return false;

          if( elem.style.display == "block" )
          {
            elem.style.display = "none"
            link.innerHTML = "show source"
          }
          else
          {
            elem.style.display = "block"
            link.innerHTML = "hide source"
          }
        }

        function openCode( url )
        {
          window.open( url, "SOURCE_CODE", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=480,width=750" ).focus();
        }
      // ]]>
    </script>
  </head>

  <body>
  <table width="100%" border='0' cellpadding='0' cellspacing='0' class='banner'><tr>
  <td class="file-title"><span class="file-title-prefix">Class</span><br />RbPlusPlus::Writers::SingleFileWriter</td>
  <td align="right">
    <table cellspacing="0" cellpadding="2">
      <tr valign="top">
        <td>In:</td>
        <td>
<a href="../../../files/lib/rbplusplus/writers/single_file_writer_rb.html">lib/rbplusplus/writers/single_file_writer.rb</a>
        </td>
      </tr>
    <tr>
      <td>Parent:</td>
      <td>
        <a href="Base.html">
Base
         </a>
     </td>
   </tr>
         </table>
        </td>
        </tr>
      </table>
 <!-- banner header -->

  <div id="bodyContent">
      <div id="content">

  <div class="description"><p>
Writer that takes a builder and writes out the code in one single file
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="#M000048">process_code</a></li>
  <li><a href="#M000047">write</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div class="method">
  <div class="title">
    <a name="M000047"></a><b>write</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000047_source')" id="l_M000047_source">show source</a> ]</p>
  <div id="M000047_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/rbplusplus/writers/single_file_writer.rb, line 7</span>
 7:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write</span>
 8:         <span class="ruby-identifier">process_code</span>(<span class="ruby-identifier">builder</span>)
 9: 
10:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Builders</span><span class="ruby-operator">::</span><span class="ruby-constant">TypesManager</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
11:           <span class="ruby-comment cmt"># Handle to_from_ruby constructions</span>
12:           <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">declarations</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Builders</span><span class="ruby-operator">::</span><span class="ruby-constant">TypesManager</span>.<span class="ruby-identifier">body</span>
13:         <span class="ruby-keyword kw">end</span>
14: 
15:         <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">name</span>
16:         <span class="ruby-identifier">cpp_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">working_dir</span>, <span class="ruby-node">&quot;#{filename}.rb.cpp&quot;</span>)
17: 
18:         <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">cpp_file</span>, <span class="ruby-value str">&quot;w+&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cpp</span><span class="ruby-operator">|</span>
19:           <span class="ruby-identifier">cpp</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">to_s</span>
20:         <span class="ruby-keyword kw">end</span>
21:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Protected Instance methods</div>
<div class="method">
  <div class="title">
    <a name="M000048"></a><b>process_code</b>(builder)
  </div>
  <div class="description">
  <p>
What we do here is to go through the builder heirarchy and push all the
code from children up to the parent, ending up with all the code in the
top-level builder
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000048_source')" id="l_M000048_source">show source</a> ]</p>
  <div id="M000048_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/rbplusplus/writers/single_file_writer.rb, line 28</span>
28:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process_code</span>(<span class="ruby-identifier">builder</span>)
29:         <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">builders</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">b</span><span class="ruby-operator">|</span>
30:           <span class="ruby-identifier">process_code</span>(<span class="ruby-identifier">b</span>)
31:         <span class="ruby-keyword kw">end</span>
32: 
33:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">parent</span>
34: 
35:         <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">parent</span>.<span class="ruby-identifier">includes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">includes</span>
36:         <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">parent</span>.<span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">body</span>
37:         <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">parent</span>.<span class="ruby-identifier">declarations</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">declarations</span>
38:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>

    </body>
</html>